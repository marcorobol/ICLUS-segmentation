<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <link href="assets/css/custom_new.min.css" rel="stylesheet">

    <link href="../javascript/video.js/video-js.min.css" rel="stylesheet" />
    <link href="https://unpkg.com/@videojs/themes@1/dist/fantasy/index.css" rel="stylesheet" />
    <style>
        .vjs-control-bar {
            position: absolute !important;
            top: -60px !important;
        }
        .vjs-big-play-button {
            position: absolute !important;
            top: -30px !important;
        }
        .vjs-volume-panel, .vjs-picture-in-picture-control, .vjs-fullscreen-control {
            visibility: hidden;
        }
    </style>

    <script src="assets/vendors/jquery/3.4.1/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>

    <script type="text/javascript">
        var urlParams;
        (window.onpopstate = function () {
            var match,
                pl     = /\+/g,  // Regex for replacing addition symbol with a space
                search = /([^&=]+)=?([^&]*)/g,
                decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
                query  = window.location.search.substring(1);

            urlParams = {};
            while (match = search.exec(query))
            urlParams[decode(match[1])] = decode(match[2]);
        })();
    </script>
    
    <script src="assets/js/fetch-segmentations.js"></script>

    <script src="assets/js/segments-table.js"></script>

    <script src="../javascript/video.js/video.min.js"></script>
</head>

<body>
    <div id="vue-root-app" class="canvas-container">

        <div class="buttons" style="top: 60px; position: relative; width: 400px;">
            <segment-form></segment-form>
        </div>

        <span class="wrapper" style="top: 60px; position: relative">

            <img class="image" src="<%= annotationPngUrl %>" style="width: 880px; position: absolute; z-index: 1; max-height: none !important;"/>

            <video
                id="my-video"
                class="video-js vjs-theme-fantasy"
                controls
                preload="auto"
                width="880"
                data-setup="{}"
                muted
                preload
                autoplay
            >
                <source src="<%= rawVideoUrl %>" type="video/mp4" preload autoplay/>
                <p class="vjs-no-js">
                    To view this video please enable JavaScript, and consider upgrading to a
                    web browser that
                    <a href="https://videojs.com/html5-video-support/" target="_blank">
                        supports HTML5 video
                    </a>
                </p>
            </video>

            <div class="positioner" style="z-index: 2; position: absolute; top: 0px;">
                <div style="padding-top: 74.9%;"> <!-- padding-top must match the aspect ratio of your image = height / width * 100% -->
                    <canvas width="1068" height="800"></canvas>
                </div>
            </div>

        </span>

        <div class="info" style="top: 60px; position: relative; width: 200px">

            <segment-table></segment-table>

            <div class="vlog"></div>
            <br/>
            <div class="log" style="position: relative"></div>

        </div>
        
    </div>




    <script type="text/javascript">
        new Vue({ el: '#vue-root-app' })
    </script>


    <script src="assets/js/segmentation-tool.js"></script>
    <script type="text/javascript">
        var segmentationTool = SegmentationTool($(".wrapper")[0]);
    </script>


    <script type="text/javascript">
        videojs('my-video').ready(function () {
            this.on('timeupdate', function () {
            // console.log(this.currentTime());
            // $(".vlog").html("currentTime:"+this.currentTime())
            $("#time")[0].value = this.currentTime()
            })
        });
    </script>

</body>
</html>